<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" dir="ltr" lang="en-gb" xml:lang="en-gb">

<!-- Mirrored from marioruns.com/forum/viewtopic.php?p=2366 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 10 Nov 2015 01:12:59 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>

<meta http-equiv="content-type" content="text/html; charset=UTF-8" />
<meta http-equiv="content-style-type" content="text/css" />
<meta http-equiv="content-language" content="en-gb" />
<meta http-equiv="imagetoolbar" content="no" />
<meta name="resource-type" content="document" />
<meta name="distribution" content="global" />
<meta name="keywords" content="" />
<meta name="description" content="" />

<title>MarioRuns Forums &bull; View topic - [GS] Always display 50th star text box after grabbing a star</title>

<link rel="alternate" type="application/atom+xml" title="Feed - MarioRuns Forums" href="feed.php" /><link rel="alternate" type="application/atom+xml" title="Feed - New Topics" href="feed9d17.php?mode=topics" /><link rel="alternate" type="application/atom+xml" title="Feed - Forum - SM64" href="feedfdc5.php?f=9" /><link rel="alternate" type="application/atom+xml" title="Feed - Topic - [GS] Always display 50th star text box after grabbing a star" href="feed1a02.php?f=9&amp;t=323" />

<link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,700' rel='stylesheet' type='text/css' />

<!--
	phpBB style name: metrolike
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:	  Eric Seguin ( http://segwin.ca/ )
-->

<script type="text/javascript">
// <![CDATA[
	var jump_page = 'Enter the page number you wish to go to:';
	var on_page = '1';
	var per_page = '';
	var base_url = '';
	var style_cookie = 'phpBBstyle';
	var style_cookie_settings = '; path=/; domain=marioruns.com';
	var onload_functions = new Array();
	var onunload_functions = new Array();

	

	/**
	* Find a member
	*/
	function find_username(url)
	{
		popup(url, 760, 570, '_usersearch');
		return false;
	}

	/**
	* New function for handling multiple calls to window.onload and window.unload by pentapenguin
	*/
	window.onload = function()
	{
		for (var i = 0; i < onload_functions.length; i++)
		{
			eval(onload_functions[i]);
		}
	};

	window.onunload = function()
	{
		for (var i = 0; i < onunload_functions.length; i++)
		{
			eval(onunload_functions[i]);
		}
	};

// ]]>
</script>
<script type="text/javascript" src="styles/prosilver/template/styleswitcher.js"></script>
<script type="text/javascript" src="styles/prosilver/template/forum_fn.js"></script>

<link href="styles/metrolike/theme/print.css" rel="stylesheet" type="text/css" media="print" title="printonly" />
<link href="style4e6a.css?id=7&amp;lang=en" rel="stylesheet" type="text/css" media="screen, projection" />

<link href="styles/metrolike/theme/normal.css" rel="stylesheet" type="text/css" title="A" />
<link href="styles/metrolike/theme/medium.css" rel="alternate stylesheet" type="text/css" title="A+" />
<link href="styles/metrolike/theme/large.css" rel="alternate stylesheet" type="text/css" title="A++" />


<style>
.headerMario {
	background:url('background.png') no-repeat;
	width: 100%;
	height: 230px;
}
.headerMarioInner {
	background:url('background2.png') no-repeat;
	width: 100%;
	height: 230px;
}
.container {
	width: 1020px;
	margin: 0 auto;
}
</style>
</head>

<body id="phpbb" class="section-viewtopic ltr">

<div class="headerMario">
<div class="container">
<a href="index.html">
<div class="headerMarioInner"></div></a>
</div>
<!--<div id="search-box">
				<form action="./search.php" method="get" id="search">
				<fieldset>
					<input name="keywords" id="keywords" type="text" maxlength="128" title="Search for keywords" class="inputbox search" value="Search…" <!--onclick="if(this.value=='Search…')this.value=''; var d=document.getElementById('search-box'); d.className='active';" onblur="if(this.value==''){this.value='Search…'; var d=document.getElementById('search-box'); d.className='';}" /><input class="button2" value="" alt="Search" type="submit" /><br />
					<a href="./search.php" title="View the advanced search options">Advanced search</a> 
				</fieldset>
				</form>
			</div>-->
</div>
<div id="wrap">

	<a id="top" name="top" accesskey="t"></a>
	<div id="page-header">
			<div class="inner content-wrap"><span class="corners-top"><span></span></span>

			
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>

		

			<span class="corners-bottom"><span></span></span></div>
		<div class="navbar">
			<div class="inner content-wrap"><span class="corners-top"><span></span></span>

			<ul class="linklist navlinks">
				<li class="icon-home"><a href="index-2.html" accesskey="h">Board index</a>  <strong>&#8249;</strong> <a href="viewforum218b.html?f=19">Super Mario 64</a> <strong>&#8249;</strong> <a href="viewforumfdc5.html?f=9">SM64</a><span style="margin-left: 5px;">&#8226;</span></li>
				
				<li><a href="../index.html">Back to Main Site</a></li>

				<li class="rightside"><a href="#" onclick="fontsizeup(); return false;" onkeypress="return fontsizeup(event);" class="fontsize" title="Change font size">Change font size</a></li>

				<li class="rightside"><a href="viewtopic8fdc.html?f=9&amp;t=323&amp;view=print" title="Print view" accesskey="p" class="print">Print view</a></li>
			</ul>

			

			<ul class="linklist rightside">
				<li class="icon-fa"><a href="faq.html" title="Frequently Asked Questions">FAQ</a></li>
				<li class="icon-registe"><a href="ucp8319.html?mode=register">Register</a></li>
					<li class="icon-logou"><a href="ucp26c3.html?mode=login" title="Login" accesskey="x">Login</a></li>
				
			</ul>

			<span class="corners-bottom"><span></span></span></div>
		</div>

	</div>

	<a name="start_here"></a>
	<div id="page-body" class="content-wrap">
		
<h2><a href="viewtopic1a02.html?f=9&amp;t=323">[GS] Always display 50th star text box after grabbing a star</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body --><div style="display: none !important;">Discuss anything SM64 related.<br /></div>

<div class="topic-actions">

	<div class="buttons">
	
		<div class="reply-icon"><a href="posting61db.html?mode=reply&amp;f=9&amp;t=323" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="search-box">
			<form method="get" id="topic-search" action="http://marioruns.com/forum/search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="text" name="keywords" id="search_keywords" size="20" value="Search this topic…" onclick="if(this.value=='Search this topic…')this.value='';" onblur="if(this.value=='')this.value='Search this topic…';" />
				<input class="button2" type="submit" value="Search" />
				<input type="hidden" name="t" value="323" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
		<div class="pagination">
			4 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	

</div>
<div class="clear"></div>


	<div id="p2366" class="post bg2 offline">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 class="first"><a href="#p2366">[GS] Always display 50th star text box after grabbing a star</a></h3>
			<p class="author"><a href="viewtopic99a0.html?p=2366#p2366"><img src="styles/metrolike/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="memberlist367b.html?mode=viewprofile&amp;u=54" style="color: #0066FF;" class="username-coloured">vegard</a></strong> &raquo; 04 Jun 2014, 21:04 </p>

			

			<div class="content">This code was requested by Harper as a way to practice Mips using the restart code after getting the 50th star in LLL (since just using the restart code by itself will not cause the text box to show after jumping out the painting, thus messing up the camera slightly).<br /><br /><span style="font-weight: bold">US:</span><br />  812573f8 0000<br />  812573fa 0000<br />  81257418 2406<br />  8125741a 0091<br /><br />In the interest of getting more GS hacking knowledge out there, here's how I found it:<br /><br />The first thing I tried was to create some save states at 49 stars and some save states at 50 stars (before the text box shows). The idea is generally to compare memory between the save states. We are looking for some flag, some byte of memory that when set to a certain value causes the text box to display. I tried to make 9 save states at 49 stars and 5 save states at 50 stars. Then I made a Python script to go over all the addresses (from 0x80000000 to 0x8040000000) and compare them; any addresses that have different values between the 49 star save states are discarded, any addresses that have different values between the 50 star save states are discarded, and any addreses which are the *same* between the 49 and the 50 star save states are discarded. This left me with 51 addresses that seemed to be candidates for this flag. I tried them out by creating a 51-line gameshark code that fixed the values of these addresses to the value they had in the 50 star save states and grabbed a random star (having e.g. 6 stars). Some of them crashed the game, you can rule those out by commenting out half of the gameshark lines and checking if the game still crashes, recursively. Unfortunately, this technique didn't work for me as I couldn't get the textbox to show.<br /><br />The second thing I tried was to patch mupen64plus to count the number of times it executes the code at a certain address. The output is a file with every address from 0x80000000 to 0x80400000 and an associated number (the number being the number of times the CPU executed an instruction from that address). These files are really useful because it allows you to compare what code was executed when you did one thing vs. what code was executed when you did another thing. So again I recorded what addresses was executed for the following scenarios: 1) when I grab the 50th star and I see the text box, 2) the same thing again, but for a different star, 3) when I have 49 stars and I die, 4) when I grab the 50th star and don't see the text box. With this data I again used a Python script to show me *only* those addresses that were executed when I got the text box. This gave me something like 3000 addresses at first, but I recorded some more traces to narrow it down to about 300 (sometimes I recorded a trace that coincidentally contained a kick when I got the 50th star and didn't contain a kick in any of the others, that would give a false positive result because the kick was confounded with seeing the text box). However, the final result of 300 addresses contained a lot of adjacent addresses, so they only belonged to 25 or so functions. I went into the disassembler for each of them and found a branch instruction that would cause an address to be executed for the 50th star but not any other. Again I used a gameshark code to patch out all of these branches (the result is that the text box should presumably appear). This worked, but when I grabbed the 50th star and got out of LLL I was shown the text box that you get the first time you enter BOB. So I narrowed down the gameshark code again using the same technique of deleting half the lines until I was left with only 2 lines that caused the BOB text box to show. Then I looked at the disassembly and saw that the code was calling a function with a certain argument (that argument was being tested in the branch that caused the text box to be displayed). So I manually changed the parameter to a fixed value (again using a gameshark code) and indeed the text inside the text box changed. Now it was just a matter of putting a breakpoint on that instruction and grabbing the 50th star to see which was the right value to fix it to.</div>

			

		</div>

		
			<dl class="postprofile" id="profile2366">
			<dt>
				<a href="memberlist367b.html?mode=viewprofile&amp;u=54"><img src="download/file8d2e.png?avatar=54_1406730296.png" width="48" height="48" alt="User avatar" /></a><br />
				<a href="memberlist367b.html?mode=viewprofile&amp;u=54" style="color: #0066FF;" class="username-coloured">vegard</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 82</dd><dd><strong>Joined:</strong> 19 Nov 2013, 14:17</dd><dd><strong>Location:</strong> France</dd>
			<dd>
				<ul class="profile-icons">
					<li class="web-icon"><a href="http://www.siglemic.net/" target="_blank" title="WWW: http://www.siglemic.net"><span>Website</span></a></li>
				</ul>
			</dd>
		

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p2416" class="post bg1 offline">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p2416">Re: [GS] Always display 50th star text box after grabbing a </a></h3>
			<p class="author"><a href="viewtopic1d38.html?p=2416#p2416"><img src="styles/metrolike/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="memberlistdb19.html?mode=viewprofile&amp;u=84">ClysmiC</a></strong> &raquo; 20 Jun 2014, 01:42 </p>

			

			<div class="content">Great little write-up. I'm surprised the first method didn't work, it sounded pretty ingenious to me.</div>

			<div id="sig2416" class="signature">1:54:18 | 53:41 | N64 | <a href="http://twitch.tv/ClysmiC" target="_blank" class="postlink">http://twitch.tv/ClysmiC</a></div>

		</div>

		
			<dl class="postprofile" id="profile2416">
			<dt>
				<a href="memberlistdb19.html?mode=viewprofile&amp;u=84"><img src="download/fileee6e.png?avatar=84_1385012321.png" width="90" height="90" alt="User avatar" /></a><br />
				<a href="memberlistdb19.html?mode=viewprofile&amp;u=84">ClysmiC</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 76</dd><dd><strong>Joined:</strong> 21 Nov 2013, 06:34</dd>

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p2417" class="post bg2 offline">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p2417">Re: [GS] Always display 50th star text box after grabbing a</a></h3>
			<p class="author"><a href="viewtopic9604.html?p=2417#p2417"><img src="styles/metrolike/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="memberlist367b.html?mode=viewprofile&amp;u=54" style="color: #0066FF;" class="username-coloured">vegard</a></strong> &raquo; 20 Jun 2014, 11:27 </p>

			

			<div class="content"><blockquote><div><cite>ClysmiC wrote:</cite>Great little write-up. I'm surprised the first method didn't work, it sounded pretty ingenious to me.</div></blockquote><br /><br />It could be that grabbing the star sets a flag which gets cleared when the text box is displayed or something. So the flag would have the same value in both the &quot;before&quot; and &quot;after&quot; save states. Dunno, just a theory.</div>

			

		</div>

		
			<dl class="postprofile" id="profile2417">
			<dt>
				<a href="memberlist367b.html?mode=viewprofile&amp;u=54"><img src="download/file8d2e.png?avatar=54_1406730296.png" width="48" height="48" alt="User avatar" /></a><br />
				<a href="memberlist367b.html?mode=viewprofile&amp;u=54" style="color: #0066FF;" class="username-coloured">vegard</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 82</dd><dd><strong>Joined:</strong> 19 Nov 2013, 14:17</dd><dd><strong>Location:</strong> France</dd>
			<dd>
				<ul class="profile-icons">
					<li class="web-icon"><a href="http://www.siglemic.net/" target="_blank" title="WWW: http://www.siglemic.net"><span>Website</span></a></li>
				</ul>
			</dd>
		

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<div id="p2701" class="post bg1 offline">
		<div class="inner"><span class="corners-top"><span></span></span>

		<div class="postbody">
			

			<h3 ><a href="#p2701">Re: [GS] Always display 50th star text box after grabbing a </a></h3>
			<p class="author"><a href="viewtopic8c86.html?p=2701#p2701"><img src="styles/metrolike/imageset/icon_post_target.gif" width="11" height="9" alt="Post" title="Post" /></a>by <strong><a href="memberlist367b.html?mode=viewprofile&amp;u=54" style="color: #0066FF;" class="username-coloured">vegard</a></strong> &raquo; 29 Oct 2014, 15:10 </p>

			

			<div class="content">This is the code for japanese:<br /><br /><span style="font-weight: bold">JP</span>:<br />  81257180 0000<br />  81257182 0000<br />  812571a0 2406<br />  812571a2 0091</div>

			

		</div>

		
			<dl class="postprofile" id="profile2701">
			<dt>
				<a href="memberlist367b.html?mode=viewprofile&amp;u=54"><img src="download/file8d2e.png?avatar=54_1406730296.png" width="48" height="48" alt="User avatar" /></a><br />
				<a href="memberlist367b.html?mode=viewprofile&amp;u=54" style="color: #0066FF;" class="username-coloured">vegard</a>
			</dt>

			

		<dd>&nbsp;</dd>

		<dd><strong>Posts:</strong> 82</dd><dd><strong>Joined:</strong> 19 Nov 2013, 14:17</dd><dd><strong>Location:</strong> France</dd>
			<dd>
				<ul class="profile-icons">
					<li class="web-icon"><a href="http://www.siglemic.net/" target="_blank" title="WWW: http://www.siglemic.net"><span>Website</span></a></li>
				</ul>
			</dd>
		

		</dl>
	

		<div class="back2top"><a href="#wrap" class="top" title="Top">Top</a></div>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<hr class="divider" />

	<form id="viewtopic" method="post" action="http://marioruns.com/forum/viewtopic.php?f=9&amp;t=323">

	<fieldset class="display-options" style="margin-top: 0; ">
		
		<label>Display posts from previous: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
		<label>Sort by <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label> <label><select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select> <input type="submit" name="sort" value="Go" class="button2" /></label>
		
	</fieldset>

	</form>
	<hr />


<div class="topic-actions">
	<div class="buttons">
	
		<div class="reply-icon"><a href="posting61db.html?mode=reply&amp;f=9&amp;t=323" title="Post a reply"><span></span>Post a reply</a></div>
	
	</div>

	
		<div class="pagination">
			4 posts
			 &bull; Page <strong>1</strong> of <strong>1</strong>
		</div>
	
</div>


	<p></p><p><a href="viewforumfdc5.html?f=9" class="left-box left" accesskey="r">Return to SM64</a></p>

	<form method="post" id="jumpbox" action="http://marioruns.com/forum/viewforum.php" onsubmit="if(this.f.value == -1){return false;}">

	
		<fieldset class="jumpbox">
	
			<label for="f" accesskey="j">Jump to:</label>
			<select name="f" id="f" onchange="if(this.options[this.selectedIndex].value != -1){ document.forms['jumpbox'].submit() }">
			
				<option value="-1">Select a forum</option>
			<option value="-1">------------------</option>
				<option value="3">Site Information</option>
			
				<option value="4">&nbsp; &nbsp;Announcements</option>
			
				<option value="8">&nbsp; &nbsp;Feedback</option>
			
				<option value="1">Community</option>
			
				<option value="2">&nbsp; &nbsp;Lounge</option>
			
				<option value="11">&nbsp; &nbsp;Introductions</option>
			
				<option value="16">&nbsp; &nbsp;Community Events</option>
			
				<option value="19">Super Mario 64</option>
			
				<option value="9" selected="selected">&nbsp; &nbsp;SM64</option>
			
				<option value="17">&nbsp; &nbsp;Research, Strats &amp; Routing</option>
			
				<option value="20">&nbsp; &nbsp;Toolbox</option>
			
				<option value="5">Off-topic</option>
			
				<option value="13">&nbsp; &nbsp;Archives</option>
			
				<option value="10">&nbsp; &nbsp;Games</option>
			
				<option value="18">&nbsp; &nbsp;Technology &amp; Hardware</option>
			
			</select>
			<input type="submit" value="Go" class="button2" />
		</fieldset>
	</form>


	<h3>Who is online</h3>
	<p>Users browsing this forum: No registered users and 4 guests</p>
</div>

<div id="page-footer">

	<div class="navbar">
		<div class="inner content-wrap"><span class="corners-top"><span></span></span>

		<ul class="linklist">
			<li class="icon-home"><a href="index-2.html" accesskey="h">Board index</a></li>
				
			<li class="rightside"><a href="memberlista2f5.html?mode=leaders">The team</a> &bull; <a href="ucp033a.html?mode=delete_cookies">Delete all board cookies</a> &bull; All times are UTC + 1 hour </li>
		</ul>

		<span class="corners-bottom"><span></span></span></div>
	</div>

	<div class="copyright content-wrap">Powered by <a href="https://www.phpbb.com/" target="_blank">phpBB</a>&reg; Forum Software &copy; phpBB Group
		<br />metrolike style by <a href="http://segwin.ca/" target="_blank">Eric Seguin</a>
		
	</div>
</div>

</div>

<div>
	<a id="bottom" name="bottom" accesskey="z"></a>
	<img src="cronb999.gif?cron_type=tidy_search" width="1" height="1" alt="cron" />
</div>

</body>

<!-- Mirrored from marioruns.com/forum/viewtopic.php?p=2366 by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 10 Nov 2015 01:12:59 GMT -->
</html>
